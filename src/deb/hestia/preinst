#!/bin/bash

# Run triggers only on updates
if [ ! -e "/usr/local/skynet/data/users/admin" ]; then
	exit
fi

if [ ! -e "/etc/skynetcp/skynet.conf" ]; then
	mkdir -p /etc/skynetcp
	echo -e "# Do not edit this file, will get overwritten on next upgrade, use /etc/skynetcp/local.conf instead\n\nexport skynet='/usr/local/skynet'\n\n[[ -f /etc/skynetcp/local.conf ]] && source /etc/skynetcp/local.conf" > /etc/skynetcp/skynet.conf
fi

# Configure apt to retry downloading on error
if [ ! -f /etc/apt/apt.conf.d/80-retries ]; then
	echo "APT::Acquire::Retries \"3\";" > /etc/apt/apt.conf.d/80-retries
fi

# Validate version number and replace if different
skynet_V=$(dpkg -s skynet | grep -i version | awk '{ print $2 }')
